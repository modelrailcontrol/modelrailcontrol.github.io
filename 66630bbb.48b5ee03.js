(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{130:function(e,n,t){"use strict";t.d(n,"a",(function(){return p})),t.d(n,"b",(function(){return u}));var a=t(0),r=t.n(a);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function b(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function c(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var m=r.a.createContext({}),o=function(e){var n=r.a.useContext(m),t=n;return e&&(t="function"==typeof e?e(n):b(b({},n),e)),t},p=function(e){var n=o(e.components);return r.a.createElement(m.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},d=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,i=e.parentName,m=c(e,["components","mdxType","originalType","parentName"]),p=o(t),d=a,u=p["".concat(i,".").concat(d)]||p[d]||s[d]||l;return t?r.a.createElement(u,b(b({ref:n},m),{},{components:t})):r.a.createElement(u,b({ref:n},m))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,i=new Array(l);i[0]=d;var b={};for(var c in n)hasOwnProperty.call(n,c)&&(b[c]=n[c]);b.originalType=e,b.mdxType="string"==typeof e?e:a,i[1]=b;for(var m=2;m<l;m++)i[m]=t[m];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},92:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return b})),t.d(n,"rightToc",(function(){return c})),t.d(n,"default",(function(){return o}));var a=t(3),r=t(7),l=(t(0),t(130)),i={title:"Meddelandestruktur"},b={unversionedId:"intro-structure",id:"intro-structure",isDocsHomePage:!1,title:"Meddelandestruktur",description:"Principen f\xf6r MQTT \xe4r att man skickar ett meddelande (payload) till ett specifikt \xe4mne (topic). Andra kan sedan v\xe4lja att lyssa p\xe5 eller prenumerera (subscribe) p\xe5 ett \xe4mne. N\xe4r n\xe5gon sen skickar (publish) ett meddelande till ett \xe4mne, kommer detta meddelande att vidarebefordras till alla som valt att prenumerera/lyssna p\xe5 detta \xe4mne.",source:"@site/docs/intro-structure.md",slug:"/intro-structure",permalink:"/docs/intro-structure",editUrl:"https://github.com/modelrailcontrol/MRC-documentation/blob/master/docs/intro-structure.md",version:"current"},c=[{value:"Ordlista",id:"ordlista",children:[]},{value:"Uppbyggnad",id:"uppbyggnad",children:[]},{value:"Attribut",id:"attribut",children:[]},{value:"Base topic",id:"base-topic",children:[]},{value:"Device",id:"device",children:[]},{value:"N\xe5gra exempel",id:"n\xe5gra-exempel",children:[]},{value:"Node",id:"node",children:[]},{value:"F\xf6reslagna funktioner",id:"f\xf6reslagna-funktioner",children:[]},{value:"Property",id:"property",children:[]}],m={rightToc:c};function o(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},m,t,{components:n,mdxType:"MDXLayout"}),Object(l.b)("p",null,"Principen f\xf6r MQTT \xe4r att man skickar ett meddelande (payload) till ett specifikt \xe4mne (topic). Andra kan sedan v\xe4lja att lyssa p\xe5 eller prenumerera (subscribe) p\xe5 ett \xe4mne. N\xe4r n\xe5gon sen skickar (publish) ett meddelande till ett \xe4mne, kommer detta meddelande att vidarebefordras till alla som valt att prenumerera/lyssna p\xe5 detta \xe4mne."),Object(l.b)("p",null,"I centrum f\xf6r detta f\xf6rfarande finns en meddelandeserver (broker). Det \xe4r en central programvara vars enda uppgift lite f\xf6renklat \xe4r att hantera \xe4mnen, meddelanden och prenumerationer. "),Object(l.b)("h3",{id:"ordlista"},"Ordlista"),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Svenska"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Engelska"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"F\xf6rklaring"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"\xe4mne"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"topic"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"meddelande"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"payload"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"enhet"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"device"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"funktion"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"node"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"egenskap"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"property"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}))))),Object(l.b)("h3",{id:"uppbyggnad"},"Uppbyggnad"),Object(l.b)("p",null,"Ett \xe4mne \xe4r alltid uppbyggt p\xe5 f\xf6ljande s\xe4tt:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/device/node/property\n")),Object(l.b)("h3",{id:"attribut"},"Attribut"),Object(l.b)("p",null,"P\xe5 varje niv\xe5 i strukturen kan man sedan s\xe4tta attribut, vilka kan varierar beroende p\xe5 niv\xe5n. Dessa attribut anv\xe4nds till att ge information om just den niv\xe5 d\xe4r attributet finns, exempelvis:"),Object(l.b)("p",null,Object(l.b)("inlineCode",{parentName:"p"},"mmrc/device/$name"),'\nd\xe4r man d\xe5 har m\xf6jlighet att ge enheten ett l\xe4sbart namn, kanske "V\xe4xel 22".'),Object(l.b)("p",null,Object(l.b)("inlineCode",{parentName:"p"},"mmrc/device/node/$name"),'\nd\xe4r man ger en av enhetens funktioner ett l\xe4sbart namn, kanske "V\xe4xelstyrning".'),Object(l.b)("p",null,Object(l.b)("inlineCode",{parentName:"p"},"mmrc/device/node/property/$name"),'\nd\xe4r man ger funktionens egenskap ett namn, kanske "Riktning".'),Object(l.b)("p",null,"Vilka attribut som finns och m\xe5ste anv\xe4ndas, finns beskrivet i ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/conv-restriction"}),"Konventionen"),"."),Object(l.b)("h3",{id:"base-topic"},"Base topic"),Object(l.b)("p",null,"Den f\xf6rsta niv\xe5n i MMRC-strukturen och som grund f\xf6r alla \xe4mnen i MMRC anv\xe4nds f\xf6ljande:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/\n")),Object(l.b)("p",null,"Denna start p\xe5 \xe4mnet visar att du f\xf6ljer MMRC-konventionen och d\xe5 ska allts\xe5 alla \xe4mnen b\xf6rja med denna text, exempelvis"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/pkin-to001/turnout/turn\nmmrc/1270262539-af/pushbutton/push\nmmrc/bwah-0012/signal/image`\n")),Object(l.b)("p",null,"G\xf6r du din egen variant av MMRC eller MQTT \xe4mnesstruktur, s\xe5 m\xe5ste du hitta p\xe5 ett eget Base topic."),Object(l.b)("h3",{id:"device"},"Device"),Object(l.b)("p",null,"Den andra niv\xe5n i MMRC-strukturen \xe4r identiteten p\xe5 och informationen om sj\xe4lva enheten:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/pkin-sj06/\n")),Object(l.b)("p",null,"H\xe4r \xe4r allts\xe5 ",Object(l.b)("inlineCode",{parentName:"p"},"pkin-sj06")," enhetens identitet i MMRC. Den identiteten m\xe5ste vara unik och l\xe4mpligen skapar man den utifr\xe5n sitt namn, j\xe4rnv\xe4gens eller modulens namn och ett l\xf6pnummer eller liknande. Exempel p\xe5 detta kan vara ",Object(l.b)("inlineCode",{parentName:"p"},"twah-sj06"),", ",Object(l.b)("inlineCode",{parentName:"p"},"mne-1955")," eller ",Object(l.b)("inlineCode",{parentName:"p"},"ssva-hfs"),"."),Object(l.b)("p",null,"De attribut som finns till den h\xf6r niv\xe5n \xe4r tre stycken och de bildar d\xe5 tre \xe4mnen som man b\xe5de kan skicka meddelanden (publish) till och h\xe4mta information (subscribe) fr\xe5n:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/pkin-sj06/$name\nmmrc/pkin-sj06/$state\nmmrc/pkin-sj06/$nodes\n")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$name")," \xe4r det mer l\xe4sv\xe4nliga namnet p\xe5 enheten. ",Object(l.b)("em",{parentName:"li"},'Exempelvis "Suckunge modul 6" eller "Holmfors station"')),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$state")," talar om i vilken status enheten befinner sig i. Detta \xe4r en speciell inst\xe4llning som \xe4ven kan visa n\xe4r en enhet pl\xf6tslig slutat fungera. H\xe4r finns det definierade status i ",Object(l.b)("a",Object(a.a)({parentName:"li"},{href:"conv-restriction"}),"Konventionen")," som ska anv\xe4ndas."),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$nodes")," \xe4r en kommaseparerad lista \xf6ver vilka olika funktioner (noder) det finns i enheten. Olika funktioner kan g\xf6ra olika saker, kanske b\xe5de hantera en knapp, en lysdiod och en v\xe4xel.  ",Object(l.b)("em",{parentName:"li"},'Exempelvis "turnout1,turnout2" eller "button,led,turnout".'))),Object(l.b)("h3",{id:"n\xe5gra-exempel"},"N\xe5gra exempel"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),'mmrc/pkin-1234/$name -> "V\xe4xel 22"\n')),Object(l.b)("p",null,"H\xe4r har allts\xe5 \xe4mnet ",Object(l.b)("inlineCode",{parentName:"p"},"mmrc/pkin-1234/$name")," f\xe5tt inneh\xe5llet ",Object(l.b)("inlineCode",{parentName:"p"},"V\xe4xel 22"),". Exempelvis kan andra enheter allts\xe5 f\xe5 reda p\xe5 vad denna enhet har f\xf6r namn genom att h\xe4mta information (subscribe) fr\xe5n \xe4mnet ",Object(l.b)("inlineCode",{parentName:"p"},"mmrc/pkin-1234/$name"),"."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),'mmrc/pkin-1234/$state -> "init"\n')),Object(l.b)("p",null,"Enhetens status har h\xe4r satts till ",Object(l.b)("inlineCode",{parentName:"p"},"init")," vilket enligt konventionen betyder att den \xe4r p\xe5 v\xe4g att starta men inte \xe4r rikigt f\xe4rdig. Programvaran i enheten ska sen s\xe4tta meddelandet ",Object(l.b)("inlineCode",{parentName:"p"},"ready")," n\xe4r den \xe4r klar att b\xf6rja anv\xe4ndas."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),'mmrc/pkin-1234/$nodes -> "turnout,button"\n')),Object(l.b)("p",null,"Det h\xe4r \xe4mnet talar om vilka funktioner en enhet har. Eftersom konventionen inte definierar vilka funktioner som kan finnas \xe4r deras namn/\xe4mne valfritt. Men ist\xe4llet m\xe5ste man d\xe5 ange deras namn h\xe4r."),Object(l.b)("p",null,"De funktioner som anges h\xe4r, blir allts\xe5 \xe4mnet f\xf6r n\xe4sta niv\xe5 i strukturen. S\xe5 f\xf6r enheten i detta exempel finns det tv\xe5 \xe4mnen p\xe5 niv\xe5 3 i strukturen, n\xe4mligen ",Object(l.b)("inlineCode",{parentName:"p"},"mmrc/pkin-1234/turnout"),"och ",Object(l.b)("inlineCode",{parentName:"p"},"mmrc/pkin-1234/button"),"."),Object(l.b)("h3",{id:"node"},"Node"),Object(l.b)("p",null,"P\xe5 den tredje niv\xe5n hamnar all information om klientens olika noder, eller kanske man kan kalla dem funktioner. F\xf6ljande inst\xe4llningar beh\xf6ver g\xf6ras per node:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"nodeID"),' \xe4r den unika identiteten f\xf6r denna node. Det kan exempelvis vara "turnout", "signal" eller "button" och om det finns flera noder av samma sort, kanske "signal1" och "signal2".'),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$name")," \xe4r det mer l\xe4sv\xe4nliga namnet p\xe5 noden. ",Object(l.b)("em",{parentName:"li"},'Exempelvis "V\xe4xel 01" eller "Infartssignal v\xe4nster"')),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$type"),' beskriver vilken typ av nod det \xe4r - vad den g\xf6r/hanterar. H\xe4r \xe4r det ganska fritt vad som anges, men l\xe4mpligt kan vara att ange n\xe5got i stil med "huvudsignal" eller "2-v\xe4gs-v\xe4xel".'),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$properties")," \xe4r en kommaseparerad lista \xf6ver vilka olika egenskaper denna node har. Informationen i denna lista kommer fr\xe5n nodens respektive egenskaper.")),Object(l.b)("h3",{id:"f\xf6reslagna-funktioner"},"F\xf6reslagna funktioner"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/pkin-1234/turnout\nmmrc/pkin-1234/button\nmmrc/pkin-1234/switch\nmmrc/pkin-1234/signal\n\nmmrc/pkin-1234/barrier\nmmrc/pkin-1234/decoupler\n")),Object(l.b)("p",null,"Har man flera liknande funktioner, exempelvis tv\xe5 knappar som styr tv\xe5 v\xe4xlar, kan man anv\xe4nda f\xf6ljande namn/funktioner:"),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{}),"mmrc/pkin-1234/turnout1\nmmrc/pkin-1234/turnout2\nmmrc/pkin-1234/button1\nmmrc/pkin-1234/button2\n")),Object(l.b)("h3",{id:"property"},"Property"),Object(l.b)("p",null,"P\xe5 sista niv\xe5n talar man om vilka egenskaper varje nod har."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"property"),' \xe4r en (av kanske flera) egenskaper som denna denna node har. F\xf6r en signal skulle det kunna vara "main" och "slave" f\xf6r huvudsignal och f\xf6rsignal eller f\xf6r enklare saker kanske bara "move", "light" eller "push".'),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$name")," \xe4r det mer l\xe4sv\xe4nliga namnet p\xe5 egenskapen. ",Object(l.b)("em",{parentName:"li"},'Exempelvis "V\xe4xeloml\xe4ggning" eller "Signalbild"')),Object(l.b)("li",{parentName:"ul"},Object(l.b)("strong",{parentName:"li"},"$datatype")," beskriver vilken typ av data som kan l\xe4sas fr\xe5n och/eller skickas till egenskapen. Vilka egenskaper som kan f\xf6rekomma finns att l\xe4sa i MMRC Convention. ",Object(l.b)("em",{parentName:"li"},'Exempelvis "string" eller "boolean".'))))}o.isMDXComponent=!0}}]);