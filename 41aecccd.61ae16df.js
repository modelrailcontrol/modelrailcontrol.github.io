(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{118:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return i})),r.d(t,"metadata",(function(){return s})),r.d(t,"rightToc",(function(){return o})),r.d(t,"default",(function(){return c}));var n=r(2),a=r(6),l=(r(0),r(157)),i={title:"Enheters programmering"},s={id:"clients/intro-02-arduino",isDocsHomePage:!1,title:"Enheters programmering",description:"Det kr\xe4vs en del f\xf6rberedelser f\xf6r att kunna programmera en Arduino kretskortsdator. Det mesta g\xf6r man bara en g\xe5ng och nedan f\xf6ljer en beskrivning av de olika stegen.",source:"@site/docs/clients/intro-02-arduino.md",permalink:"/docs/clients/intro-02-arduino",editUrl:"https://github.com/modelrailcontrol/MRC-documentation/docs/docs/clients/intro-02-arduino.md",sidebar:"Enheter",previous:{title:"\xd6versikt",permalink:"/docs/clients/intro-01-overview"},next:{title:"Enheters inst\xe4llningar",permalink:"/docs/clients/intro-03-wifi"}},o=[{value:"Arduino IDE",id:"arduino-ide",children:[]},{value:"Drivrutin f\xf6r USB-krets CH340",id:"drivrutin-f\xf6r-usb-krets-ch340",children:[]},{value:"Kretskortsdatorn",id:"kretskortsdatorn",children:[{value:"Steg 1 - L\xe4gg till kort",id:"steg-1---l\xe4gg-till-kort",children:[]},{value:"Steg 2 - Installera kort",id:"steg-2---installera-kort",children:[]},{value:"Steg 3 - V\xe4lj kretskortsdator",id:"steg-3---v\xe4lj-kretskortsdator",children:[]},{value:"Steg 4 - Starta om",id:"steg-4---starta-om",children:[]}]},{value:"Bibliotek",id:"bibliotek",children:[{value:"Steg 1 - Hantera bibliotek",id:"steg-1---hantera-bibliotek",children:[]},{value:"Steg 2 - Installera bibliotek",id:"steg-2---installera-bibliotek",children:[]}]},{value:"MMRC programvara",id:"mmrc-programvara",children:[]},{value:"Anslut kretskortsdatorn",id:"anslut-kretskortsdatorn",children:[]},{value:"Testa!",id:"testa",children:[]},{value:"St\xe4nga av meddelanden",id:"st\xe4nga-av-meddelanden",children:[]}],d={rightToc:o};function c(e){var t=e.components,r=Object(a.a)(e,["components"]);return Object(l.b)("wrapper",Object(n.a)({},d,r,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"Det kr\xe4vs en del f\xf6rberedelser f\xf6r att kunna programmera en Arduino kretskortsdator. Det mesta g\xf6r man bara en g\xe5ng och nedan f\xf6ljer en beskrivning av de olika stegen."),Object(l.b)("h2",{id:"arduino-ide"},"Arduino IDE"),Object(l.b)("p",null,"B\xf6rja med att ladda hem Arduinos IDE/utvecklingsmilj\xf6 fr\xe5n sidan ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.arduino.cc/en/Main/Software"}),"https://www.arduino.cc/en/Main/Software"),". Det finns versioner f\xf6r b\xe5de Windows, Mac och Linux. Installera utvecklingsmilj\xf6n p\xe5 din dator, instruktioner finns p\xe5 sidan ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.arduino.cc/en/Guide/HomePage"}),"https://www.arduino.cc/en/Guide/HomePage"),"."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw01.png",alt:null}))),Object(l.b)("p",null,"Observera att man i Linux kan f\xe5 ett felmeddelande om \xe5tkomst till serieporten (Error opening serial port\u2026) f\xf6rsta g\xe5ngen man startar utvecklingsmilj\xf6n. Detta har att g\xf6ra med en begr\xe4nsad beh\xf6righet och det finns instruktioner f\xf6r hur det \xe5tg\xe4rdas l\xe4ngst ner p\xe5 installationssidan f\xf6r Linux."),Object(l.b)("h2",{id:"drivrutin-f\xf6r-usb-krets-ch340"},"Drivrutin f\xf6r USB-krets CH340"),Object(l.b)("p",null,"F\xf6r vissa (billigare?) kretskortsdatorer m\xe5ste man p\xe5 Windows installera drivrutiner f\xf6r en USB-krets som heter CH340. Det finns en beskrivning av hur man g\xf6r detta hos exempelvis Lawicel: ",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"http://www.lawicel.se/blog/esp8266-d1-mini-med-ch340/"}),"http://www.lawicel.se/blog/esp8266-d1-mini-med-ch340/")),Object(l.b)("h2",{id:"kretskortsdatorn"},"Kretskortsdatorn"),Object(l.b)("p",null,"F\xf6r att kunna programmera Arduinos med ESP8266-kretsar beh\xf6ver den typen av kort l\xe4ggas till i Arduinos utvecklingsmilj\xf6. Det sker p\xe5 f\xf6ljande s\xe4tt."),Object(l.b)("h3",{id:"steg-1---l\xe4gg-till-kort"},"Steg 1 - L\xe4gg till kort"),Object(l.b)("p",null,"G\xe5 till utvecklingsmilj\xf6ns inst\xe4llningar via Fil -> Inst\xe4llningar. L\xe4gg sen till webbadressen \u201d",Object(l.b)("a",Object(n.a)({parentName:"p"},{href:"http://arduino.esp8266.com/stable/package_esp8266com_index.json%E2%80%9D"}),"http://arduino.esp8266.com/stable/package_esp8266com_index.json\u201d")," i f\xe4ltet \u201cAdditional Board Manager URLs\u201d och klicka p\xe5 Ok-knappen."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw02.png",alt:null}))),Object(l.b)("h3",{id:"steg-2---installera-kort"},"Steg 2 - Installera kort"),Object(l.b)("p",null,"\xd6ppna sedan Korthanteraren via menyn Verktyg -> Kort: \u201dxxxx\u201d -> Korthanterare\u2026 Scrolla ner till eller s\xf6k efter \u201cesp8266\u201d och klicka sedan p\xe5 Install-knappen (saknas p\xe5 denna bild) f\xf6r att installera kortet. St\xe4ng sedan Korthanteraren."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw03.png",alt:null}))),Object(l.b)("h3",{id:"steg-3---v\xe4lj-kretskortsdator"},"Steg 3 - V\xe4lj kretskortsdator"),Object(l.b)("p",null,"V\xe4lj nu den kretskortsdator du vill arbeta med via menyn Verktyg -> Kort: \u201dxxxx\u201d. I fallet med en Wemos eller klon, kan man v\xe4lja \u201cLOLIN(WEMOS) D1 R2 & Mini\u201d. Du m\xe5ste \xe4ven v\xe4lja vilken port kretskortsdatorn \xe4r ansluten via menyn Verktyg -> Port."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw04.png",alt:null}))),Object(l.b)("h3",{id:"steg-4---starta-om"},"Steg 4 - Starta om"),Object(l.b)("p",null,"Avsluta nu Arduinos utvecklingsmilj\xf6 och starta den igen."),Object(l.b)("h2",{id:"bibliotek"},"Bibliotek"),Object(l.b)("p",null,"Programvaran f\xf6r MMRC anv\xe4nder en del f\xe4rdiga funktioner fr\xe5n olika bibliotek eller \u201dlibraries\u201d. Dessa bibliotek m\xe5ste ocks\xe5 l\xe4ggas till i utvecklingsmilj\xf6n."),Object(l.b)("h3",{id:"steg-1---hantera-bibliotek"},"Steg 1 - Hantera bibliotek"),Object(l.b)("p",null,"I Arduino utvecklingsmilj\xf6n v\xe4ljer du menyn Verktyg -> Hantera bibliotek\u2026 S\xf6k sedan efter biblioteket i filtreringsrutan."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw05.png",alt:null}))),Object(l.b)("h3",{id:"steg-2---installera-bibliotek"},"Steg 2 - Installera bibliotek"),Object(l.b)("p",null,"N\xe4r du hittat r\xe4tt bibliotek, klickar d\xe5 p\xe5 Installera-knappen (saknas i bilden ovan) f\xf6r att installera den senaste versionen av biblioteket. Upprepa nu detta f\xf6r samtliga bibliotek som beh\xf6vs."),Object(l.b)("pre",null,Object(l.b)("code",Object(n.a)({parentName:"pre"},{}),"EasyButton by Evert Arias\nIotWebConf by Balazs Kelemen\nPubSubClient by Nick O\u2019Leary\n")),Object(l.b)("p",null,"N\xe4r du nu installerat alla n\xf6dv\xe4ndiga kort och bibliotek, \xe4r utvecklingsmilj\xf6n klar f\xf6r programmering."),Object(l.b)("h2",{id:"mmrc-programvara"},"MMRC programvara"),Object(l.b)("p",null,"Nu \xe4r det dags att ladda hem och installera sj\xe4lva MMRC-programvaran. F\xf6rst ska programvaran laddas hem och fr\xe5n Github, normalt via en ZIP-fil."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw06.png",alt:null}))),Object(l.b)("p",null,"Packa sedan upp ZIP-filen i mappen f\xf6r Arduino utvecklingsmilj\xf6ns skissbok (var den mappen finns, kan man se via menyn Fil -> Inst\xe4llningar). Starta sedan Arduino utvecklingsmilj\xf6n och v\xe4lj Fil -> Skissbok och sen den programvara du nyss laddade hem."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw08.png",alt:null}))),Object(l.b)("p",null,"F\xf6rsta g\xe5ngen du installerar och k\xf6r MMRC-programvaran kan det vara l\xe4mplig att se vad som h\xe4nder i programmet. Starta d\xe4rf\xf6r Seriell monitor via menyn Verktyg -> Seriell monitor och se till att hastigheten \xe4r satt till 9600 baud."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw09.png",alt:null}))),Object(l.b)("h2",{id:"anslut-kretskortsdatorn"},"Anslut kretskortsdatorn"),Object(l.b)("p",null,"Anslut nu kretskortsdatorn via vald USB-port (Verktyg -> Port). Det kan vara l\xe4mpligt att inte ha servon anslutna till kretskortsdatorn f\xf6rsta g\xe5ngen man startar den, eftersom deras l\xe4ge \xe4r ok\xe4nt och de kan st\xe4llas i fel/konstiga l\xe4gen."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw11.png",alt:null}))),Object(l.b)("p",null,"Som n\xe4sta steg \xe4r det nu dags att installera programvaran p\xe5 kretskortsdatorn. Det g\xf6r man via menyn Skiss \u2013> Ladda upp, Ctrl+U eller med pilh\xf6ger-symbolen i verktygsraden. Uppladdningen kan ta n\xe5gra sekunder och sen \xe4r MMRC f\xf6rhoppningsvis ig\xe5ng."),Object(l.b)("h2",{id:"testa"},"Testa!"),Object(l.b)("p",null,"Har allt g\xe5tt bra s\xe5 ska du nu i Seriell Monitor kunna se att kretskortsdator g\xf6r en massa olika saker. Du ska exempelvis kunna se att MMRC f\xf6rs\xf6ker skapa ett eget n\xe4tverk (AP) och att den publicerar och prenumererar p\xe5 en del MQTT-meddelanden. Beroende p\xe5 vad du nu har kopplat till kretskortsdatorn ska du nu kunna testa dess olika funktioner och se vad som h\xe4nder i Seriell monitor."),Object(l.b)("h2",{id:"st\xe4nga-av-meddelanden"},"St\xe4nga av meddelanden"),Object(l.b)("p",null,"En nackdel med Seriell monitor \xe4r att den ibland kanske \u201dkrockar\u201d med en utg\xe5ng p\xe5 kretskortsdatorn som \xe4ven MMRC anv\xe4nder. S\xe5 n\xe4r du \xe4r klar med testandet och ser att MMRC fungerar som det ska, kan du l\xe4mpligen st\xe4nga av utskrifterna till Seriell monitor."),Object(l.b)("p",null,Object(l.b)("img",Object(n.a)({parentName:"p"},{src:"../../img/mmrc-sw10.png",alt:null}))),Object(l.b)("p",null,"Du st\xe4nger av utskrifterna genom att leta reda p\xe5 raden \u201dbyte debug = 1;\u201d i programkoden. \xc4ndra till en nolla (0) ist\xe4llet \u201dbyte debug = 0;\u201d och spara programmet. Ladda upp programvaran i kretskortsdatorn igen och d\xe4refter ska \xe4ven funktioner kopplade till kretskortsdatorns Tx-utg\xe5ng fungera med MMRC."))}c.isMDXComponent=!0},157:function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return m}));var n=r(0),a=r.n(n);function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var d=a.a.createContext({}),c=function(e){var t=a.a.useContext(d),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},b=function(e){var t=c(e.components);return a.a.createElement(d.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},p=a.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,l=e.originalType,i=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),b=c(r),p=n,m=b["".concat(i,".").concat(p)]||b[p]||u[p]||l;return r?a.a.createElement(m,s(s({ref:t},d),{},{components:r})):a.a.createElement(m,s({ref:t},d))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=r.length,i=new Array(l);i[0]=p;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var d=2;d<l;d++)i[d]=r[d];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,r)}p.displayName="MDXCreateElement"}}]);